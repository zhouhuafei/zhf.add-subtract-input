"use strict";var extend=require("zhf.extend"),getDomArray=require("zhf.get-dom-array");function AddSubtractInput(a){this.opts=extend({add:null,subtract:null,input:null,step:1,min:1,value:1,max:99999999,offClass:"_off",isAsync:!1,callbackAsync:function(){},callback:function(){}},a),this.init()}AddSubtractInput.prototype.render=function(){var a=this.opts,t={};t.cbFnAsync=a.callbackAsync,t.cbFn=a.callback,t.add=getDomArray(a.add)[0],t.subtract=getDomArray(a.subtract)[0],t.input=getDomArray(a.input)[0],t.step=Number(a.step),t.min=Number(a.min),t.value=Number(a.value)||1,t.max=Number(a.max),t.offClass=a.offClass,t.isAsync=a.isAsync,this.handleData=t},AddSubtractInput.prototype.init=function(){this.render(),this.power()},AddSubtractInput.prototype.power=function(){var a=this,t=a.handleData;a.handleValue(t.value),t.add&&t.add.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.isAsync?a.handleData.cbFnAsync({self:a,handleData:t,step:t.step,type:"add"}):(t.value+=t.step,a.handleValue(t.value))}),t.subtract&&t.subtract.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.isAsync?a.handleData.cbFnAsync({self:a,handleData:t,step:t.step,type:"subtract"}):(t.value-=t.step,a.handleValue(t.value))}),t.input&&t.input.addEventListener("blur",function(e){e.preventDefault(),e.stopPropagation(),t.isAsync?a.handleData.cbFnAsync({self:a,handleData:t,step:t.step,type:"blur"}):(t.value=Number(this.value)||1,a.handleValue(t.value))})},AddSubtractInput.prototype.handleValue=function(a){var t=this.handleData;t.add&&t.add.classList.remove(t.offClass),t.subtract&&t.subtract.classList.remove(t.offClass),t.max<=0&&(t.max=t.min),a<=t.min&&(a=t.min,t.subtract&&t.subtract.classList.add(t.offClass)),a>=t.max&&(a=t.max,t.add&&t.add.classList.add(t.offClass)),a===t.min&&a===t.max&&(t.add&&t.add.classList.add(t.offClass),t.subtract&&t.subtract.classList.add(t.offClass),t.input&&(t.input.readOnly=!0)),t.input&&(t.input.value=a),t.cbFn({min:t.min,max:t.max,value:a})},module.exports=AddSubtractInput;